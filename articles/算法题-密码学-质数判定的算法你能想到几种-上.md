---
theme: channing-cyan
---

å°çŸ¥è¯†ï¼Œå¤§æŒ‘æˆ˜ï¼æœ¬æ–‡æ­£åœ¨å‚ä¸ã€Œ[ç¨‹åºå‘˜å¿…å¤‡å°çŸ¥è¯†](https://juejin.cn/post/7008476801634680869 "https://juejin.cn/post/7008476801634680869")ã€åˆ›ä½œæ´»åŠ¨ã€‚æœ¬æ–‡å·²å‚ä¸ã€Œ[æ˜åŠ›æ˜Ÿè®¡åˆ’](https://juejin.cn/post/7012210233804079141 "https://juejin.cn/post/7012210233804079141")ã€ï¼Œèµ¢å–åˆ›ä½œå¤§ç¤¼åŒ…ï¼ŒæŒ‘æˆ˜åˆ›ä½œæ¿€åŠ±é‡‘ã€‚

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æŠ«ç€ç‹¼çš®çš„ğŸã€‚ä»Šå¤©ç»™å¤§å®¶ä»‹ç»å‡ ä¸ªç”¨äºç´ æ€§æµ‹è¯•ï¼ˆprimality testï¼‰çš„ç¡®å®šæ€§ç®—æ³•ï¼Œé€‚ç”¨äº**åˆ¤æ–­ç»™å®šæ•´æ•° `n` æ˜¯å¦ä¸ºè´¨æ•°**ã€‚æ³¨æ„ï¼Œè¿™é‡Œä¸è€ƒè™‘ `0`ã€`1` ç­‰å…¶ä»–ä¸æ˜¯è´¨æ•°ä¹Ÿä¸æ˜¯åˆæ•°çš„æ•°ï¼Œåœ¨å®é™…åº”ç”¨ä¸Šå¤§å®¶è®°å¾—è‡ªå·±åŠ  `if` åˆ¤æ–­ã€‚

## è¯•é™¤æ³•ï¼ˆTrial Divisionï¼‰+ ä¼˜åŒ–
æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œéå†ä» 2 åˆ° `n-1` çš„æ‰€æœ‰æ•°å­—ï¼Œå¹¶æ£€æŸ¥å…¶æ˜¯å¦èƒ½æ•´é™¤ `n`ï¼Œæ‰¾åˆ°äº†ä¾¿è¿”å› `False`ã€‚

```python
def is_prime(n):
    for x in range(2, n):
        if n % x == 0:
            return False
    return True
```

### ä¼˜åŒ– 1
å¦‚æœ `n` æ˜¯åˆæ•°ï¼Œé‚£ä¹ˆå¿…ç„¶å­˜åœ¨ä¸¤ä¸ªçº¦æ•° $p_1$ å’Œ $p_2$ï¼Œä¸” $p_1 \le \sqrt{n} \le p_2$ã€‚ç®€å•æ¥è¯´ï¼Œå› æ•°æ˜¯ä¸€å¯¹ä¸€å¯¹å‡ºç°çš„ï¼Œè€Œ $\sqrt{n}$ å°±æ˜¯é‚£ä¸ªâ€œå¯¹ç§°è½´â€ï¼Œæˆ‘ä»¬ä¸å¿…æŠŠæ‰€æœ‰å°äº `n-1` çš„æ•°éƒ½è¯•ä¸€æ¬¡ï¼Œåˆ° `x == sqrt(n)` å°±å¯ä»¥åœä¸‹äº†ã€‚

```python
from math import isqrt  // Python ç‰ˆæœ¬ >= 3.8

def is_prime(n):
    for x in range(2, isqrt(n) + 1):
        if n % x == 0:
            return False
    return True
```

### ä¼˜åŒ– 2
å¦‚æœ `n` èƒ½è¢«ä¸€ä¸ªå¶æ•°æ•´é™¤ï¼Œé‚£ä¹ˆå®ƒä¸€å®šèƒ½è¢« 2 æ•´é™¤ï¼Œåˆç†å§ï¼Ÿå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡é™¤äº† 2 ä»¥å¤–çš„æ‰€æœ‰å¶æ•°ã€‚

```python
from math import isqrt  // Python ç‰ˆæœ¬ >= 3.8

def is_prime(n):
    if n == 2:
        return True
    elif n % 2 == 0:
        return False
        
    for x in range(3, isqrt(n) + 1, 2):
        if n % x == 0:
            return False
    return True
```

### ä¼˜åŒ– 3
> é™¤äº† `2` ä¸ `3`ï¼Œæ‰€æœ‰è´¨æ•°ä¸€å®šèƒ½è¡¨è¾¾æˆ `6k+1` æˆ– `6k+5` çš„å½¢å¼ï¼Œ`k` ä¸ºä¸€ä¸ªæ­£æ•´æ•°ã€‚
>
>ï¼ˆè´¨æ•°ä¸€å®šèƒ½è¡¨è¾¾æˆè¿™ä¸ªå½¢å¼ï¼Œä½†èƒ½è¡¨è¾¾æˆè¿™ä¸ªå½¢å¼çš„æ•°ä¸ä¸€å®šæ˜¯è´¨æ•°ã€‚ï¼‰

**è®ºè¯**

- `6k` èƒ½è¢« `6` æ•´é™¤ï¼Œä¸æ˜¯è´¨æ•°;
- `6k+2` å’Œ `6k+4` èƒ½è¢« `2` æ•´é™¤ï¼Œä¸æ˜¯è´¨æ•°ï¼›
- `6k+3` èƒ½è¢« `3` æ•´é™¤ï¼Œä¸æ˜¯è´¨æ•°ï¼›

é‚£ä¹ˆå°±åªå‰©ä¸‹ `6k+1` å’Œ `6k+5` æœ‰å¯èƒ½è´¨æ•°äº†ã€‚

æ³¨ï¼š`6k+5` ä¹Ÿå¯ä»¥å†™æˆ `6k-1`ï¼Œå› ä¸º $5 \equiv -1 \pmod 6$ã€‚

å¯¹äºæœ‰å¯èƒ½æ˜¯è´¨æ•°çš„æ•°ï¼Œæˆ‘ä»¬è¿˜å¾—ç”¨è¯•é™¤æ³•ï¼ŒèŒƒå›´è¿˜èƒ½å†è¿›ä¸€æ­¥çš„ç¼©å° â€”â€” åœ¨èƒ½è¡¨ç¤ºæˆ `6k+1` æˆ– `6k+5` çš„æ•°ä¸­å¯»æ‰¾å› æ•°å°±å¯ä»¥äº†ã€‚

ä¸ºä»€ä¹ˆï¼Ÿ

æ‰€æœ‰çš„åˆæ•°éƒ½èƒ½åˆ†è§£æˆè´¨æ•°ï¼Œæ‰€ä»¥ `n` åªéœ€è¦ä¸å¯èƒ½æ˜¯è´¨æ•°çš„æ•°ï¼ˆå³ `6k+1` æˆ– `6k+5`ï¼‰åˆ¤æ–­å°±å¯ä»¥äº†ã€‚

```python
def is_prime3(n):
    if n == 2 or n == 3:
        return True
    # ä¸èƒ½è¡¨è¾¾æˆ 6k+1 æˆ– 6k+5 çš„æ•°ä¸€å®šä¸æ˜¯è´¨æ•°
    if n % 6 != 1 and n % 6 != 5:
        return False
    # è¿›ä¸€æ­¥çš„åˆ¤æ–­
    for x in range(5, int(sqrt(n)) + 1, 6):
        if n % x == 0 or n % (x + 2) == 0:
            return False
    return True
```

## å¨å°”é€Šå®šç†ï¼ˆWilson's Theoremï¼‰
æ•°è®ºå››å¤§å®šç†ä¹‹ä¸€ï¼š

> å½“ä¸”ä»…å½“ $n$ æ˜¯è´¨æ•°æ—¶ï¼š
> $$
> (n - 1)! \equiv -1 \pmod n
> $$

ç®€å•æ¥è¯´ï¼Œå¦‚æœ `n` æ˜¯è´¨æ•°ï¼Œåˆ™ `n-1` çš„é˜¶ä¹˜åŠ  1 é™¤ä»¥ `n` çš„ä½™æ•°ä¸º 0ã€‚

**è®ºè¯**

$$\{1, 2, \dots, n-1\}$$ é‡Œçš„æ¯ä¸ªå…ƒç´  $$a$$ éƒ½ä¼šæœ‰ä¸€ä¸ªæ¨¡ $$n$$ çš„å€’æ•° $$a^* \in \{1,2,\dots,n-1\}$$ï¼Œå³ $$aa^* \equiv 1 \pmod n$$ã€‚ï¼ˆè¿™é‡Œå°±ä¸è®ºè¯è¿™å¥è¯äº†â€¦â€¦ï¼‰

è‹¥ $$a = a^*$$ï¼Œ
$$
\begin{aligned}
a^2 &\equiv 1 \pmod n \\
a^2 - 1 &\equiv 0 \\
(a - 1)(a + 1) &\equiv 0\\
\\
a &\in \{1,\,n-1\}
\end{aligned}
$$

åªæœ‰ 1 å’Œ $$n-1$$ çš„æ¨¡å€’æ•°æ˜¯è‡ªèº«ï¼Œ$$\{2,3,\dots,n-2\}$$ å†…çš„æ¯ä¸ªæ•°éƒ½æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„æ¨¡å€’æ•°ã€‚ä¸¤ä¸¤é…å¯¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰å‡ ä¸ªæ¨¡ $$n$$ ç­‰äº $$1$$ çš„å¯¹ã€‚

$$
\begin{aligned}
(n-1)! &\equiv -1 \pmod n \\
1 \times [2 \times 3 \times \dots \times (n - 2)] \times (n-1) 
&\equiv -1 \\
1 \times 1 \times (n - 1) &\equiv -1 \\
n - 1 &\equiv -1 \\
n &\equiv 0
\end{aligned}
$$

è¯æ˜å®Œæ¯•ï¼Œä¸Šä»£ç ã€‚

```python
from math import factorial

def is_prime(n):
    return (factorial(n - 1) + 1) % n == 0
```

## AKSç´ æ€§æµ‹è¯•ï¼ˆAgrawalâ€“Kayalâ€“Saxena Primality Testï¼‰

> $n$ æ˜¯è´¨æ•°å½“ä¸”ä»…å½“ï¼š
>
> $$n$$ èƒ½æ•´é™¤ $$(x + 1)^n - (x^n + 1)$$ çš„å±•å¼€å¼çš„æ‰€æœ‰ç³»æ•°ã€‚

**è®ºè¯**

åˆ©ç”¨äºŒé¡¹å¼å®šç†ï¼ˆbinomial theoremï¼‰ï¼Œå±•å¼€åŸå¼ï¼š
$$
\begin{aligned}
(x + 1)^n - (x^n + 1) &= \sum_{r=0}^{n}{\binom{n}{r} x^r} - (x^n + 1) \\
&= \sum_{r=1}^{n-1}{\binom{n}{r} x^r}
\end{aligned}
$$

å¯ä»¥çœ‹å¾—å‡ºï¼Œ$$x^n + 1$$ è¿™é¡¹å»æ‰äº† $$(x + 1)^n$$ å±•å¼€å¼çš„é¦–å°¾é¡¹ã€‚é‚£ä¹ˆä¸Šæ–¹çš„å®šç†ä¹Ÿå¯ä»¥è¿™ä¹ˆè¡¨è¾¾ï¼š

> $n$ æ˜¯è´¨æ•°å½“ä¸”ä»…å½“ï¼š
>
> $$n$$ èƒ½æ•´é™¤ $$\binom{n}{r}, r=1,2,\dots,n-2,n-1$$ã€‚

è®© $$N = \binom{n}{r}$$ï¼Œ
$$
\begin{aligned}
N &= \frac{n!}{(n-r)!\,r!} \\
n! &= N(n-r)!\,r!
\end{aligned}
$$

æ˜¾ç„¶ $$n$$ èƒ½æ•´é™¤ $$n!$$ï¼Œé‚£ä¹ˆ $$n$$ å°±èƒ½æ•´é™¤ $$N(n-r)!\,r!$$ã€‚å¦‚æœä¸€ä¸ªæ•°èƒ½æ•´é™¤ä¸€ä¸ªå‡ ä¸ªæ•°çš„ç§¯ï¼Œé‚£ä¹ˆå®ƒä¸€å®šè‡³å°‘èƒ½æ•´é™¤å®ƒä»¬ä¹‹ä¸€ã€‚ç”±äº $$p$$ ä¸èƒ½æ•´é™¤
- $$(p-r)!$$ï¼Œå› ä¸º $$(p-k)<p$$ ä¸” $$p$$ æ˜¯è´¨æ•°ï¼›
- $$r!$$ï¼Œå› ä¸º $$k<p$$ ä¸” $$p$$ æ˜¯è´¨æ•°ï¼›
é‚£ä¹ˆå®ƒä¸€å®šèƒ½æ•´é™¤ $$N$$ã€‚

è¿™ä¸ªå®šç†å¯¹äºè´¨æ•°æˆç«‹ã€‚

---

å½“ $$n$$ ä¸ºåˆæ•°æ—¶ï¼Œ

è®© $$c$$ ä¸º $$n$$ çš„å› æ•°ï¼Œ$$n=cd$$ã€‚æ˜¾è€Œæ˜“è§ï¼Œ$$c,d \in \{1,2,\dots,n-1\}$$ã€‚

$$
\begin{aligned}
\binom{n}{c} &= \frac{n!}{(n-c)!\,c!} \\
&= \frac{n(n-1)\dots(n-c+1)\cancel{(n-c)!}}{\cancel{(n-c)!}\,c!} \\
&= \frac{n(n-1)\dots(n-c+1)}{c!}
\end{aligned}
$$

å¦‚æœä¸Šæ–¹çš„å¼å­å¯ä»¥è¢« $$n$$ æ•´é™¤ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šæœ‰ä¸€ä¸ªæ­£æ•´æ•° $$k$$ ä½¿å¾— $$\binom{n}{c} = kn$$ã€‚

$$
\begin{aligned}
\frac{\cancel{n}(n-1)\dots(n-c+1)}{c!} &= k\cancel{n} \\
k &= \frac{(n-1)(n-2)\dots(n-c+1)}{c!}
\end{aligned}
$$

è®©æˆ‘ä»¬çœ‹çœ‹ $$k$$ æ˜¯ä¸æ˜¯æ•´æ•°ã€‚

$$
\begin{aligned}
(n-1)(n-2)\dots(n-c+1) &\equiv (p-1)\times(p-2)\times\dots\times1 \pmod p \\
&\equiv (p-1)!
\end{aligned}
$$

æ ¹æ®å¨å°”é€Šå®šç†ï¼Œ

$$
(p-1)! \equiv -1 \pmod p
$$

$$k$$ ä¸å¯èƒ½æ˜¯æ•´æ•°ã€‚è¿™ä¸ªå®šç†å¯¹äºåˆæ•°ä¸æˆç«‹ã€‚

è®ºè¯å®Œæ¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```python
from math import comb  // Python ç‰ˆæœ¬ >= 3.8

def is_prime(n):
    for r in range(1, n):  // (n-1) + 1 = n
        if comb(n, r) % n != 0:
            return False
    return True
```

### ä¼˜åŒ–
> $$
> \binom{n}{k}=\binom{n}{n-k}
> $$

$$\binom{n}{1}=\binom{n}{n-1}$$ï¼Œ$$\binom{n}{2}=\binom{n}{n-2}$$ï¼Œä»¥æ­¤ç±»æ¨ã€‚å› æ­¤ï¼Œ`range` çš„èŒƒå›´å¯ä»¥ç¼©å°ä¸€åŠã€‚

```python
from math import comb  // Python ç‰ˆæœ¬ >= 3.8

def is_prime(n):
    for r in range(1, n // 2 + 1):
        if comb(n, r) % n != 0:
            return False
    return True
```

**èµ¶ç´§ç‚¹èµï¼Œä¸ç„¶ä½ ä¸‹æ¬¡é¢è¯•é‡åˆ°çš„é¢˜ç›®å°±æ˜¯è¿™é¢˜ã€‚**

ä¸‹ç¯‡æ–‡ç« å°†ç»™å¤§å®¶ä»‹ç»å‡ ä¸ªæ•ˆç‡æ›´é«˜çš„æ¦‚ç‡æ€§ç®—æ³•ï¼ˆprobabilistic testï¼‰ã€‚å°±è¿™æ ·ï¼Œæ‹œæ‹œã€‚
